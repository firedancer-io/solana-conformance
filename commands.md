# `solana-conformance`

Validate effects from clients using Protobuf messages.

**Usage**:

```console
$ solana-conformance [OPTIONS] COMMAND [ARGS]...
```

**Options**:

* `--install-completion`: Install completion for the current shell.
* `--show-completion`: Show completion for the current shell, to copy it or customize the installation.
* `--help`: Show this message and exit.

**Commands**:

* `configure-fuzzcorp`: Configure FuzzCorp API credentials...
* `create-env`: Set up environment for debugging a...
* `create-fixtures`: Create test fixtures from a directory of...
* `debug-mismatch`: Debug a single repro by hash.
* `debug-mismatches`: Run tests on a set of targets with a list...
* `decode-protobufs`: Convert Context and/or Fixture messages to...
* `download-repro`: Download a single repro by hash from...
* `download-repros`: Download repros from FuzzCorp NG for...
* `exec-fixtures`: Execute fixtures and check for correct...
* `execute`: Execute Context or Fixture message(s) and...
* `fix-to-ctx`: Extract Context messages from Fixtures.
* `fuzz`: Run the fuzzcorp 'fuzz' binary with the...
* `list-harness-types`: List harness types available for use.
* `list-repros`: List all available repro lineages.
* `mass-regenerate-fixtures`: Regenerate features for fixtures in...
* `regenerate-fixtures`: Regenerate features in fixture messages.
* `run-tests`: Run tests on a set of targets with a...

## `solana-conformance configure-fuzzcorp`

Configure FuzzCorp API credentials (interactive).

**Usage**:

```console
$ solana-conformance configure-fuzzcorp [OPTIONS]
```

**Options**:

* `--force`: Force reconfiguration even if config exists
* `--clear`: Clear all cached configuration
* `--validate`: Validate current configuration and token
* `--use-ng`: (No-op, kept for compatibility)  [default: True]
* `--help`: Show this message and exit.

## `solana-conformance create-env`

Set up environment for debugging a mismatch from FuzzCorp

**Usage**:

```console
$ solana-conformance create-env [OPTIONS]
```

**Options**:

* `-s, --solana-target PATH`: Solana (or ground truth) shared object (.so) target file path  [default: .]
* `-h, --default-harness-type TEXT`: Harness type to use for Context protobufs  [default: InstrHarness]
* `-t, --target PATH`: Shared object (.so) target file paths (pairs with --keep-passing). Targets must have required function entrypoints defined  [default: .]
* `-o, --output-dir PATH`: Output directory for messages  [required]
* `-u, --repro-urls TEXT`: Comma-delimited list of FuzzCorp mismatch links
* `-n, --section-names TEXT`: Comma-delimited list of FuzzCorp section names
* `-f, --fuzzcorp-url TEXT`: Comma-delimited list of FuzzCorp section names  [default: https://api.dev.fuzzcorp.asymmetric.re/uglyweb/firedancer-io/solfuzz/bugs/]
* `-l, --log-level INTEGER`: FD logging level  [default: 5]
* `-r, --randomize-output-buffer`: Randomizes bytes in output buffer before shared library execution
* `-p, --num-processes INTEGER`: Number of processes to use  [default: 4]
* `-l, --section-limit INTEGER`: Limit number of fixture per section  [default: 0]
* `-fd, --firedancer-repo PATH`: Path to firedancer repository
* `-tv, --test-vectors-repo PATH`: Path to test-vectors repository
* `--use-ng`: Use fuzz NG CLI (fuzz list/download repro) instead of API scraping  [default: True]
* `-d, --debug-mode`: Enables debug mode, which disables multiprocessing
* `--help`: Show this message and exit.

## `solana-conformance create-fixtures`

Create test fixtures from a directory of Context and/or Fixture messages.
Effects are generated by the target passed in with --solana-target or -s.
You can also pass in additional targets with --target or -t
and use --keep-passing or -k to only generate effects for test cases that match.

**Usage**:

```console
$ solana-conformance create-fixtures [OPTIONS]
```

**Options**:

* `-i, --input PATH`: Input protobuf file or directory of protobuf files  [required]
* `-h, --default-harness-type TEXT`: Harness type to use for Context protobufs  [default: InstrHarness]
* `-s, --solana-target PATH`: Solana (or ground truth) shared object (.so) target file path  [default: .]
* `-t, --target PATH`: Shared object (.so) target file paths (pairs with --keep-passing). Targets must have required function entrypoints defined
* `-o, --output-dir PATH`: Output directory for fixtures  [required]
* `-p, --num-processes INTEGER`: Number of processes to use  [default: 4]
* `-r, --readable`: Output fixtures in human-readable format
* `-k, --keep-passing`: Only keep passing test cases
* `-g, --group-by-program`: Group fixture output by program type
* `-l, --log-level INTEGER`: FD logging level  [default: 5]
* `-d, --debug-mode`: Enables debug mode, which disables multiprocessing
* `--help`: Show this message and exit.

## `solana-conformance debug-mismatch`

Debug a single repro by hash.

**Usage**:

```console
$ solana-conformance debug-mismatch [OPTIONS] REPRO_HASH
```

**Arguments**:

* `REPRO_HASH`: Hash of the repro to debug  [required]

**Options**:

* `-l, --lineage TEXT`: Lineage name (e.g., sol_vm_syscall_cpi_rust_diff_hf)  [required]
* `-s, --solana-target PATH`: Solana (or ground truth) shared object (.so) target file path  [default: .]
* `-t, --target PATH`: Shared object (.so) target file paths to test against reference  [default: .]
* `-o, --output-dir PATH`: Output directory for test results  [required]
* `-h, --default-harness-type TEXT`: Harness type to use for Context protobufs  [default: InstrHarness]
* `--log-level INTEGER`: FD logging level  [default: 5]
* `-r, --randomize-output-buffer`: Randomizes bytes in output buffer before shared library execution
* `--interactive / --no-interactive`: Prompt for authentication if needed  [default: interactive]
* `-d, --debug`: Enable debug mode for detailed output
* `--use-ng`: (No-op, kept for compatibility)  [default: True]
* `--help`: Show this message and exit.

## `solana-conformance debug-mismatches`

Run tests on a set of targets with a list of FuzzCorp mismatch links.

Note: each `.so` target filename must be unique.

**Usage**:

```console
$ solana-conformance debug-mismatches [OPTIONS]
```

**Options**:

* `-s, --solana-target PATH`: Solana (or ground truth) shared object (.so) target file path  [default: .]
* `-h, --default-harness-type TEXT`: Harness type to use for Context protobufs  [default: InstrHarness]
* `-t, --target PATH`: Shared object (.so) target file paths (pairs with --keep-passing). Targets must have required function entrypoints defined  [default: .]
* `-o, --output-dir PATH`: Output directory for messages  [required]
* `-u, --repro-urls TEXT`: Comma-delimited list of FuzzCorp mismatch links
* `-n, --section-names TEXT`: Comma-delimited list of FuzzCorp section names
* `-f, --fuzzcorp-url TEXT`: Comma-delimited list of FuzzCorp section names  [default: https://api.dev.fuzzcorp.asymmetric.re/uglyweb/firedancer-io/solfuzz/bugs/]
* `-l, --log-level INTEGER`: FD logging level  [default: 5]
* `-r, --randomize-output-buffer`: Randomizes bytes in output buffer before shared library execution
* `-p, --num-processes INTEGER`: Number of processes to use  [default: 4]
* `-l, --section-limit INTEGER`: Limit number of fixture per section  [default: 0]
* `--use-ng`: Use fuzz NG CLI (fuzz list/download repro) instead of API scraping  [default: True]
* `-d, --debug-mode`: Enables debug mode, which disables multiprocessing
* `--help`: Show this message and exit.

## `solana-conformance decode-protobufs`

Convert Context and/or Fixture messages to human-readable format.

**Usage**:

```console
$ solana-conformance decode-protobufs [OPTIONS]
```

**Options**:

* `-i, --input PATH`: Input protobuf file or directory of protobuf files  [required]
* `-o, --output-dir PATH`: Output directory for base58-encoded, Context and/or Fixture human-readable messages  [required]
* `-p, --num-processes INTEGER`: Number of processes to use  [default: 4]
* `-h, --default-harness-type TEXT`: Harness type to use for Context protobufs  [default: InstrHarness]
* `-d, --debug-mode`: Enables debug mode, which disables multiprocessing
* `--help`: Show this message and exit.

## `solana-conformance download-repro`

Download a single repro by hash from FuzzCorp NG.

**Usage**:

```console
$ solana-conformance download-repro [OPTIONS] REPRO_HASH
```

**Arguments**:

* `REPRO_HASH`: Hash of the repro to download  [required]

**Options**:

* `-l, --lineage TEXT`: Lineage name (e.g., sol_vm_syscall_cpi_rust_diff_hf)  [required]
* `-o, --output-dir PATH`: Output directory for downloaded repro  [default: fuzzcorp_downloads]
* `--interactive / --no-interactive`: Prompt for authentication if needed  [default: interactive]
* `--use-ng`: (No-op, kept for compatibility)  [default: True]
* `--help`: Show this message and exit.

## `solana-conformance download-repros`

Download repros from FuzzCorp NG for specified lineages.

**Usage**:

```console
$ solana-conformance download-repros [OPTIONS]
```

**Options**:

* `-o, --output-dir PATH`: Output directory for downloaded repros  [default: fuzzcorp_downloads]
* `-n, --section-names TEXT`: Comma-delimited list of lineage names to download  [required]
* `-l, --section-limit INTEGER`: Limit number of repros per lineage (0 = all verified)  [default: 0]
* `-p, --num-processes INTEGER`: Number of parallel download processes  [default: 4]
* `--use-ng`: Use fuzz NG CLI (fuzz list/download repro) instead of API scraping  [default: True]
* `--interactive / --no-interactive`: Prompt for authentication if needed  [default: interactive]
* `--help`: Show this message and exit.

## `solana-conformance exec-fixtures`

Execute fixtures and check for correct effects

**Usage**:

```console
$ solana-conformance exec-fixtures [OPTIONS]
```

**Options**:

* `-i, --input PATH`: Input protobuf file or directory of protobuf files  [required]
* `-t, --target PATH`: Shared object (.so) target file path to execute  [required]
* `-o, --output-dir PATH`: Output directory for test results  [required]
* `-r, --randomize-output-buffer`: Randomizes bytes in output buffer before shared library execution
* `-l, --log-level INTEGER`: FD logging level  [default: 2]
* `-p, --num-processes INTEGER`: Number of processes to use  [default: 4]
* `-f, --failures-only`: Only log failed test cases
* `-sf, --save-failures`: Saves failed test cases to results directory
* `-ss, --save-successes`: Saves successful test cases to results directory
* `-d, --debug-mode`: Enables debug mode, which disables multiprocessing
* `--help`: Show this message and exit.

## `solana-conformance execute`

Execute Context or Fixture message(s) and print the Effects.

**Usage**:

```console
$ solana-conformance execute [OPTIONS]
```

**Options**:

* `-i, --input PATH`: Input protobuf file or directory of protobuf files  [required]
* `-h, --default-harness-type TEXT`: Harness type to use for Context protobufs  [default: InstrHarness]
* `-t, --target PATH`: Shared object (.so) target file path to execute  [required]
* `-r, --randomize-output-buffer`: Randomizes bytes in output buffer before shared library execution
* `-l, --log-level INTEGER`: FD logging level  [default: 2]
* `-n, --no-print-effects`: Do not print effects to stdout
* `-evm, --enable-vm-tracing`: Enable FD VM tracing
* `-sf, --solcap_file PATH`: file path for firedancer solcap output used for debugging bank hash mismatches in block level fixtures  [required]
* `--help`: Show this message and exit.

## `solana-conformance fix-to-ctx`

Extract Context messages from Fixtures.

**Usage**:

```console
$ solana-conformance fix-to-ctx [OPTIONS]
```

**Options**:

* `-i, --input PATH`: Input Fixture file or directory of Fixture files  [required]
* `-o, --output-dir PATH`: Output directory for messages  [required]
* `-p, --num-processes INTEGER`: Number of processes to use  [default: 4]
* `-d, --debug-mode`: Enables debug mode, which disables multiprocessing
* `--help`: Show this message and exit.

## `solana-conformance fuzz`

Run the fuzzcorp 'fuzz' binary with the provided arguments.

**Usage**:

```console
$ solana-conformance fuzz [OPTIONS]
```

**Options**:

* `--help`: Show this message and exit.

## `solana-conformance list-harness-types`

List harness types available for use.

**Usage**:

```console
$ solana-conformance list-harness-types [OPTIONS]
```

**Options**:

* `--help`: Show this message and exit.

## `solana-conformance list-repros`

List all available repro lineages.

**Usage**:

```console
$ solana-conformance list-repros [OPTIONS]
```

**Options**:

* `--use-ng`: Use fuzz NG API instead of web scraping  [default: True]
* `-l, --lineage TEXT`: Filter to specific lineage (shows all repros in that lineage)
* `--interactive / --no-interactive`: Enable interactive configuration prompts if credentials are missing  [default: interactive]
* `-f, --fuzzcorp-url TEXT`: FuzzCorp URL for web scraping (used when --use-ng is not set)  [default: https://api.dev.fuzzcorp.asymmetric.re/uglyweb/firedancer-io/solfuzz/bugs/]
* `--help`: Show this message and exit.

## `solana-conformance mass-regenerate-fixtures`

Regenerate features for fixtures in provided test-vectors folder.

**Usage**:

```console
$ solana-conformance mass-regenerate-fixtures [OPTIONS]
```

**Options**:

* `-i, --input PATH`: Input test-vectors directory  [required]
* `-o, --output-dir PATH`: Output directory for regenerated fixtures  [required]
* `-t, --target PATH`: Shared object (.so) target file path to execute  [default: .]
* `-f, --add-feature TEXT`: List of feature pubkeys to force add to the fixtures.
* `-r, --remove-feature TEXT`: List of feature pubkeys to force remove from the fixtures.
* `-k, --rekey-feature TEXT`: List of feature pubkeys to rekey in the fixtures, formatted 'old/new' (e.g. `--rekey-feature old/new`).
* `-a, --regenerate-all`: Regenerate all fixtures, regardless of feature set changes
* `-p, --num-processes INTEGER`: Number of processes to use  [default: 4]
* `-d, --dry-run`: Only print the fixtures that would be regenerated
* `-v, --verbose`: Verbose output: print filenames that will be regenerated
* `--debug-mode`: Enables debug mode, which disables multiprocessing
* `--help`: Show this message and exit.

## `solana-conformance regenerate-fixtures`

Regenerate features in fixture messages.

**Usage**:

```console
$ solana-conformance regenerate-fixtures [OPTIONS]
```

**Options**:

* `-i, --input PATH`: Either a file or directory containing messages  [required]
* `-t, --target PATH`: Shared object (.so) target file path to execute  [default: .]
* `-o, --output-dir PATH`: Output directory for regenerated fixtures  [required]
* `-d, --dry-run`: Only print the fixtures that would be regenerated
* `-f, --add-feature TEXT`: List of feature pubkeys to force add to the fixtures.
* `-r, --remove-feature TEXT`: List of feature pubkeys to force remove from the fixtures.
* `-k, --rekey-feature TEXT`: List of feature pubkeys to rekey in the fixtures, formatted 'old/new' (e.g. `--rekey-feature old/new`).
* `-a, --regenerate-all`: Regenerate all fixtures, regardless of feature set changes
* `-p, --num-processes INTEGER`: Number of processes to use  [default: 4]
* `-l, --log-level INTEGER`: FD logging level  [default: 5]
* `-v, --verbose`: Verbose output: print filenames that will be regenerated
* `--debug-mode`: Enables debug mode, which disables multiprocessing
* `--help`: Show this message and exit.

## `solana-conformance run-tests`

Run tests on a set of targets with a directory of Context and/or Fixture messages.

Note: each `.so` target filename must be unique.

**Usage**:

```console
$ solana-conformance run-tests [OPTIONS]
```

**Options**:

* `-i, --input PATH`: Input protobuf file or directory of protobuf files  [required]
* `-h, --default-harness-type TEXT`: Harness type to use for Context protobufs  [default: InstrHarness]
* `-s, --solana-target PATH`: Solana (or ground truth) shared object (.so) target file path  [default: .]
* `-t, --target PATH`: Shared object (.so) target file paths  [default: .]
* `-o, --output-dir PATH`: Output directory for test results  [default: test_results]
* `-p, --num-processes INTEGER`: Number of processes to use  [default: 4]
* `-r, --randomize-output-buffer`: Randomizes bytes in output buffer before shared library execution
* `-ch, --chunk-size INTEGER`: Number of test results per file  [default: 10000]
* `-v, --verbose`: Verbose output: log failed test cases
* `-c, --consensus-mode`: Only fail on consensus failures. One such effect is to normalize error codes when comparing results. Note: Cannot be used with --core-bpf-mode or --ignore-compute-units-mode.
* `-cb, --core-bpf-mode`: Deliberately skip known mismatches between BPF programs and builtins, only failing on genuine mimatches. For example, builtin programs may throw errors on readonly account state violations sooner than BPF programs, compute unit usage will be different, etc. This feature is primarily used to test a BPF program against a builtin. Note: Cannot be used with --consensus-mode or --ignore-compute-units-mode.
* `--ignore-compute-units`: Skip mismatches on only compute units. Good for testing two versions of a BPF program, where one is expected to use different amounts of compute units than the other. Note: Cannot be used with --consensus-mode or --core-bpf-mode.
* `-f, --failures-only`: Only log failed test cases
* `-sf, --save-failures`: Saves failed test cases to results directory
* `-ss, --save-successes`: Saves successful test cases to results directory
* `-l, --log-level INTEGER`: FD logging level  [default: 5]
* `-d, --debug-mode`: Enables debug mode, which disables multiprocessing
* `-fe, --fail-early`: Stop test execution on the first failure
* `--help`: Show this message and exit.
